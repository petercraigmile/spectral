

fft1 <- function (x) {
  ## ======================================================================
  ## Calculates
  ##
  ##   J( k/n ) = sum_{t=1}^n x_t exp(-i 2 \pi (k/n) t)
  ##
  ## for k = 0, ..., (n-1)
  ## ======================================================================
  
  n <- length(x)
  exp(-2i * pi * (0:(n-1)) / n) * fft(x)
}

